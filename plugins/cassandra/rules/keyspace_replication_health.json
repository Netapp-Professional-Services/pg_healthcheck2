{
  "replication_health_issues": {
    "metric_keywords": ["cassandra", "keyspace", "replication", "health", "strategy", "factor"],
    "rules": [
      {
        "expression": "'SimpleStrategy' in data.get('replication', {}).get('class', '')",
        "level": "high",
        "score": 7,
        "reasoning": "Keyspace '{data.get('keyspace_name')}' uses SimpleStrategy replication, which is not datacenter-aware and unsuitable for production, risking data unavailability during failures.",
        "recommendations": [
          "Alter to NetworkTopologyStrategy: ALTER KEYSPACE {data.get('keyspace_name')} WITH replication = {{'class': 'NetworkTopologyStrategy', '<dc>': 3}}",
          "Plan maintenance window and run 'nodetool repair -full' post-change"
        ]
      },
      {
        "expression": "'NetworkTopologyStrategy' in data.get('replication', {}).get('class', '') and min([v for k,v in data.get('replication', {}).items() if k != 'class' and isinstance(v, int)]) < 2",
        "level": "high",
        "score": 7,
        "reasoning": "Keyspace '{data.get('keyspace_name')}' has replication factor < 2 in at least one datacenter, insufficient for fault tolerance in production environments.",
        "recommendations": [
          "Increase RF to 3: ALTER KEYSPACE {data.get('keyspace_name')} WITH replication = {{'class': 'NetworkTopologyStrategy', '<dc>': 3}}",
          "Verify with 'nodetool describecluster' and run 'nodetool repair' if needed"
        ]
      }
    ]
  }
}