{
  "high_compaction_activity": {
    "metric_keywords": [
      "compaction_history"
    ],
    "data_conditions": [
      {
        "key": "count",
        "exists": true
      }
    ],
    "rules": [
      {
        "expression": "data.get('count', 0) > settings.get('compaction_recent_threshold', 20)",
        "level": "high",
        "score": 7,
        "reasoning": "Elevated compaction activity detected with {data.get('count')} recent operations. Frequent compactions can indicate SSTable backlog, leading to increased I/O, read amplification, and potential latency spikes.",
        "recommendations": [
          "Run `nodetool compactionstats` to check for pending or stalled compactions and address any long-running tasks.",
          "Evaluate table compaction strategies; switch to SizeTieredCompactionStrategy or LeveledCompactionStrategy based on workload (write-heavy vs. read-heavy).",
          "Increase heap size or adjust concurrent_compactors if CPU-bound during peaks.",
          "Monitor disk usage and consider adding nodes if write throughput is consistently high."
        ]
      },
      {
        "expression": "data.get('count', 0) > 10",
        "level": "medium",
        "score": 5,
        "reasoning": "Moderate compaction activity with {data.get('count')} recent operations. This is within normal range but warrants monitoring for trends.",
        "recommendations": [
          "Periodically review compaction metrics using OpsCenter or custom monitoring.",
          "Ensure repairs are run regularly to prevent repair-induced compactions."
        ]
      }
    ]
  }
}