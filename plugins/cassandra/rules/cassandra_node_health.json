{
  "node_isolation": {
    "metric_keywords": [
      "peers"
    ],
    "data_conditions": [
      {
        "key": "count",
        "exists": true
      }
    ],
    "rules": [
      {
        "expression": "data.get('count', 0) < settings.get('min_peers', 1)",
        "level": "high",
        "score": 8,
        "reasoning": "Node has only {data.get('count')} peers, below the minimum threshold of {settings.get('min_peers', 1)}. This suggests the node is isolated from the cluster, risking data inconsistency and availability issues.",
        "recommendations": [
          "Verify network connectivity between nodes using ping or telnet on the storage_port (default 7000).",
          "Check cassandra.yaml for correct listen_address and rpc_address configurations.",
          "Run 'nodetool status' on other nodes to confirm cluster view; perform a nodetool gossipinfo if needed.",
          "If persistent, restart the node or investigate firewall/DNS issues."
        ]
      }
    ]
  },
  "low_uptime": {
    "metric_keywords": [
      "local_node"
    ],
    "data_conditions": [
      {
        "key": "data",
        "exists": true
      }
    ],
    "rules": [
      {
        "expression": "data[0].get('uptime', 0) < 3600 if data else False",
        "level": "medium",
        "score": 6,
        "reasoning": "Node uptime is only {data[0].get('uptime', 0)} seconds, indicating a recent restart. Frequent restarts can point to stability issues like OOM errors or configuration problems.",
        "recommendations": [
          "Review Cassandra logs (/var/log/cassandra/system.log) for errors around the restart time.",
          "Check JVM heap settings (MAX_HEAP_SIZE) and ensure sufficient system resources (CPU, memory).",
          "Monitor for recurring restarts; consider increasing gossip heartbeat intervals if network latency is high."
        ]
      }
    ]
  }
}