{
    "failed_rollup_jobs": {
        "metric_keywords": ["rollup_jobs"],
        "data_conditions": [
            {"key": "has_failed", "operator": "==", "value": true}
        ],
        "rules": [
            {
                "expression": "data.get('has_failed') == True",
                "level": "critical",
                "score": 8,
                "reasoning": "One or more rollup jobs have failed. Historical data aggregation is not completing.",
                "recommendations": [
                    "Check rollup job errors: GET /_rollup/job/<job_id>",
                    "Review source index availability",
                    "Check for field type mismatches",
                    "Note: Rollup is deprecated in ES 8.x - consider migrating to downsampling"
                ]
            }
        ]
    },
    "stopped_rollup_jobs": {
        "metric_keywords": ["rollup_jobs"],
        "data_conditions": [
            {"key": "has_stopped", "operator": "==", "value": true},
            {"key": "has_failed", "operator": "==", "value": false}
        ],
        "rules": [
            {
                "expression": "data.get('has_stopped') == True and data.get('has_failed') == False",
                "level": "medium",
                "score": 4,
                "reasoning": "Rollup jobs are stopped. Rollup indices may not be up to date.",
                "recommendations": [
                    "Start stopped jobs: POST /_rollup/job/<job_id>/_start",
                    "Review if rollup jobs should be running continuously",
                    "Consider migrating to downsampling for ES 8.x+"
                ]
            }
        ]
    }
}
