{
  "query_spills_to_disk": {
    "metric_keywords": [
      "temp_files"
    ],
    "rules": [
      {
        "expression": "True",
        "level": "medium",
        "score": 5,
        "reasoning": "The query '{data.get('query')}' created temporary files on disk, writing {data.get('total_temp_written')}. This indicates that the operation could not fit in `work_mem`, leading to slower performance due to disk I/O.",
        "recommendations": [
          "Analyze the query using `EXPLAIN ANALYZE` to understand the cause of the disk sort, hash, or aggregation.",
          "Consider increasing the `work_mem` session parameter for this specific query, or globally if memory allows and other queries would also benefit.",
          "Investigate if adding or improving an index could provide a pre-sorted data path, avoiding the need for a large in-memory sort."
        ]
      }
    ]
  }
}
