# Trend Collection Configuration
# This file contains settings specific to trend data collection

# Database connection for the target PostgreSQL instance being monitored
target_database:
  host: "your-db-host.example.com"
  port: 5432
  database: "your_database"
  user: "your_user"
  password: "your_password"
  ssl_mode: "prefer"  # Options: disable, allow, prefer, require, verify-ca, verify-full

# Company/System identification
company_name: "Your Company Name"
database_name: "your_database"  # Should match target_database.database
host_name: "your-db-host.example.com"  # Should match target_database.host

# Trend storage settings
trend_storage_enabled: true
trend_database:
  host: "trend-db.example.com"
  port: 5432
  database: "health_check_trends"
  user: "trend_user"
  password: "your_secure_password"
  ssl_mode: "require"

# Collection settings
collection:
  # Enable/disable specific module categories
  enable_connection_analysis: true
  enable_performance_analysis: true
  enable_security_analysis: true
  enable_index_analysis: true
  enable_table_analysis: true
  enable_query_analysis: true
  
  # Skip specific modules (comma-separated)
  skip_modules: ""
  # Example: "get_osinfo,datadog_setup"
  
  # Collection timeout (seconds)
  timeout_seconds: 300
  
  # Enable verbose logging
  verbose_logging: false

# Trend analysis configuration
trend_analysis:
  default_days_back: 30
  alert_thresholds:
    connection_utilization: 0.8      # Alert if connections > 80%
    query_performance_degradation: 0.2  # Alert if query time increases > 20%
    failed_modules_increase: 0.1     # Alert if failed modules increase > 10%
    collection_failure_rate: 0.2     # Alert if collection fails > 20% of time

# Data retention settings
data_retention:
  # Keep detailed data for this many days
  detailed_data_days: 90
  
  # Keep summary data for this many days
  summary_data_days: 365
  
  # Archive old data to separate table
  archive_enabled: true
  archive_after_days: 90

# Output settings
output:
  # Save structured data to files
  save_structured_data: true
  
  # Directory for structured data files
  structured_data_dir: "trend_data"
  
  # Log file location
  log_file: "logs/trend_collection.log"
  
  # Enable JSON output for external tools
  enable_json_output: true

# Performance settings
performance:
  # Connection pool size
  max_connections: 5
  
  # Query timeout (seconds)
  query_timeout: 30
  
  # Batch size for bulk operations
  batch_size: 1000

# Monitoring and alerting
monitoring:
  # Enable collection metrics
  enable_metrics: true
  
  # Metrics collection interval (seconds)
  metrics_interval: 60
  
  # Alert on collection failures
  alert_on_failures: true
  
  # Alert on high resource usage
  alert_on_high_usage: true

# Environment-specific configurations

# Development environment
development:
  target_database:
    host: "localhost"
    port: 5432
    database: "dev_database"
    user: "dev_user"
    password: "dev_password"
  trend_storage_enabled: true
  trend_database:
    host: "localhost"
    port: 5432
    database: "health_check_trends_dev"
    user: "trend_user"
    password: "dev_password"
  collection:
    verbose_logging: true
    timeout_seconds: 600

# Production environment
production:
  target_database:
    host: "prod-db.company.com"
    port: 5432
    database: "production_database"
    user: "app_user"
    password: "${DB_PASSWORD}"  # Use environment variable
    ssl_mode: "require"
  trend_storage_enabled: true
  trend_database:
    host: "trend-db-prod.company.com"
    port: 5432
    database: "health_check_trends_prod"
    user: "trend_user"
    password: "${TREND_DB_PASSWORD}"  # Use environment variable
    ssl_mode: "require"
  collection:
    verbose_logging: false
    timeout_seconds: 300
  monitoring:
    alert_on_failures: true
    alert_on_high_usage: true

# Staging environment
staging:
  target_database:
    host: "staging-db.company.com"
    port: 5432
    database: "staging_database"
    user: "app_user"
    password: "${STAGING_DB_PASSWORD}"
    ssl_mode: "require"
  trend_storage_enabled: true
  trend_database:
    host: "trend-db-staging.company.com"
    port: 5432
    database: "health_check_trends_staging"
    user: "trend_user"
    password: "${STAGING_TREND_DB_PASSWORD}"
    ssl_mode: "require"
  collection:
    verbose_logging: true
    timeout_seconds: 600 